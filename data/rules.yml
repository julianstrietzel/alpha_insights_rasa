version: "3.1"

rules:
  - rule: Fallback rule forwarding to LLM
    steps:
      - intent: nlu_fallback
      - action: action_defog_fallback
  - rule: Bot challenge
    steps:
      - intent: einleitung_bot_herausforderung
      - action: utter_bot_challenge
  - rule: user id provided
    steps:
      - intent: benutzer_id_bereitstellen
      - action: action_grund_info
  - rule: basic_user_details
    steps:
      - intent: grund_info
      - action: action_grund_info
  - rule: get current bp status
    steps:
      - intent: aktueller_bd_status
      - action: action_aktueller_bd_status
  - rule: get more details about current bp if user asks
    steps:
      - intent: erweiterter_bd_status
      - action: action_erweiterter_bd_status
  - rule: get bp readings outside target range
    steps:
      - intent: ablesungen_ausserhalb_zielbereich
      - action: action_ablesungen_ausserhalb_zielbereich
  - rule: get details about outliers
    steps:
      - intent: details_ausreisser
      - action: action_details_ausreisser
  - rule: get turning points
    steps:
      - intent: wendepunkte
      - action: action_wendepunkte
  - rule: get trend changes due to medication
    steps: # TODO Only if change date is set!
      - intent: trendaenderungen_medikation
      - action: action_trendaenderungen_medikation
  - rule: get trends more generally over the recent time spans
    steps:
      - intent: trends
      - action: action_trends
  - rule: get changes over the day e.g. compare morning and evening
    steps:
      - intent: veraenderungen_ueber_tag
      - action: action_veraenderungen_ueber_tag
  - rule: liste alle bd werte auf
    steps:
      - intent: auflisten_bd
      - action: action_auflisten_bd

  - rule: trigger gpt fallback
    steps:
      - intent: ask_gpt
      - action: action_gpt_fallback

  - rule: trigger defog fallback
    steps:
      - intent: ask_defog
      - action: action_defog_fallback


